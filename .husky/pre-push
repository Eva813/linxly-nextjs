# ===============================
# Professional DevOps Pre-push Hook
# Fast-fail strategy: type-check â†’ build
# ===============================

echo "ğŸš€ Running professional CI checks with fast-fail strategy..."

# Step 1: Type Check (Fast - ~10-30s)
echo ""
echo "ğŸ”§ Step 1/2: TypeScript Type Check"
echo "â° Running type check..."
if ! npm run type-check; then
  echo ""
  echo "âŒ Type check failed! Please fix TypeScript errors before pushing."
  echo "ğŸ’¡ Run 'npm run type-check' to see detailed errors."
  exit 1
fi
echo "âœ… Type check passed!"

# Step 2: Build (Slow - ~1-5min)
echo ""
echo "ğŸ—ï¸  Step 2/2: Production Build"
echo "â° Running build (this may take a few minutes)..."
if ! npm run build; then
  echo ""
  echo "âŒ Build failed! Please fix build errors before pushing."
  echo "ğŸ’¡ Run 'npm run build' locally to debug issues."
  exit 1
fi
echo "âœ… Build successful!"

echo ""
echo "ğŸ‰ All checks passed! Ready to push."
echo "ğŸ’¡ For AI code review, run: npm run review"
echo "ğŸ“Š Summary: âœ… Type-check â†’ âœ… Build"